# SenseCode

SenseCode 是基于商汤 SenseCore 大装置 及 SenseNova 日日新大模型而开发的代码助手。

## 设置 API Key

您还需要持有 SenseCode 产品团队分发的 API Key 才能使用 SenseCode 功能。您可以在 SenseCode 侧边栏助手视图时，点击标题栏上的 `齿轮图标` 进入设置页面。点击 API Key 配置项尾部的 `钥匙图标` 来进行设置。

## 编辑器内代码补全

您可以在编辑器内通过自动或手动方式触发代码补全，一经触发，编辑器状态栏右下的 `⟁` 图标将指示现在的请求状态。

在设置页面中，可以配置编辑器内代码补全的触发方式：

* 手动：当按下热键时获取补全建议，默认的热键为 `Ctrl + /`, 您可以点击右侧 `键盘图标` 进入设置来进行修改
* 自动：当输入停止时获取补全建议，您可以点击 `秒表图标` 来切换延迟时间的长短，此时手动触发仍然有效

补全模式：

* 行级补全：补全当前代码行，此模式下在接受将某项建议后，会自动连续触发
* 块级补全：补全代码块，尽可能多的一次性返回补全信息，此模式不会连续触发

以及补全建议的相关设置：

* 候选建议数量：通过点击右侧 `数字图标` 可以切换返回候选条目的数量

触发补全事件后，稍等片刻补全内容会以行内补全候选框形式出现，您可以使用 `Tab` 键接受建议。候选数量大于 1, 可以使用 `Alt + [` 及 `Alt + ]` 来进行翻页浏览，确定要接受的建议项后，使用 `Tab` 键插入编辑器。

> VS Code 编辑器在触发补全事件后，如遇用户的其他选择、移动、输入行为，则会 **取消** 补全操作。当前补全结果响应时间可能较长，需要您等待片刻。

## 在编辑器内触发 SenseCode 命令

如果在编辑器内选择了部分内容再触发热键，将会在 Code Action 菜单中显示 SenseCode 命令，您可以选择执行。

您也可以手动点击 Code Action 的 `灯泡图标` 以显示所有可用动作，并从中选择。

## 在侧边栏助手内使用 SenseCode 命令

SenseCode 的侧边栏助手在没有问答历史的状态下，将显示首页，其中包含所有可用 SenseCode 命令的快捷按钮，以及用户自定义提示词的快捷按钮。您可以从编辑器内选择代码后，点击按钮执行响应操作。

当开始对话后，将进入对话列表页面。此时您仍可以从页面底部的 `提问` 按钮中找到所有 SenseCode 命令，可以继续选择代码并点击执行。

SenseCode 的侧边栏助手中，默认为流式输出模式，即回答将在产生过程中逐步显示，以便于您提早审阅结果，在这种模式下，您可以随时点击 `停止回答` 按钮来终止此次回答。

您也可以在设置页面中将回答模式改为整体输出，此时将等待完整结果返回，并一次性显示。

部分操作可能需要用户补全提示，完成补全后可以点击 `发送图标` 或 `Ctrl + Enter` 提交内容。

对于结果中可识别的代码内容，插件将以代码框形式显示，并提供 `复制` 和 `插入到当前文件位置` 的按钮，便于您的操作。

## 在工作区打开新的助手页面

为便于多线开发，SenseCode 可以在工作区内打开多个新的助手页面，您可以在 SenseCode 侧边栏助手视图时，点击标题栏上的 `多窗口图标` 新建。

## 评价回答结果

在回答结束或回答被终止后，答案底部将显示评价按钮，如果您接受了 SenseCode 的隐私协议，当您点击对应按钮时，我们将收集你的评价反馈，这对我们改进算法和产品设计很有帮助，十分感谢您的支持。

## 自定义提示词

您可以自定义提示词，以更好地适用于您的使用场景。在配置页面点击自定义提示词 `魔棒图标`，将帮您定位到 SenseCode 的设置中，您可以在此添加自己的提示词，插件将在侧边栏中生成对应的操作按钮。

提示词中可以包含 `${code}` 来标识该提示需要抓取用户框选的代码，一并提交 `SenseCode` 处理。

提示词中可以包含用户填空，可以使用 `${input}` 来标识需要填写对应位置的信息后再发送。为了更好地提示用户，您可以为当前填空编写占位符，在内容为空时显示提示。如 `${input:language}` 将会显示可编辑文本框，并以 `language` 作为提示信息占位显示。

## 清除所有配置

在设置页面中点击清除所有配置 `重置图标`，将清除所有配置，恢复默认状态，清除内容包括：

* **隐私协议**：接受状态将被重置为 `未选择`
* **后端引擎**：如有自定义后端引擎配置，将被清空
* **API Key**：所有加密存储中保存的后端引擎 API Key 将被清空
* **自定义提示词**：如有将被清空
* **其余设置**：恢复默认值

## 开发计划

* **Improvement** 加入 AST 解析，以优化发送代码的质量（防止发送无意义的截断代码，对部分复杂代码仅提取签名信息等）
* **Feature** 加入代码解释，以及为代码生成注释和文档的功能
* **Feature** 支持多文件或项目级上下文提取，并在多轮回答中参考这些内容
* **Stretch** 按用户输入的意图，自动分解任务为多轮操作，实现复杂功能

## 问题反馈

如使用过程中遇到问题或有任何改进意见，欢迎发送邮件到 <sensecode@sensetime.com> 反馈。
